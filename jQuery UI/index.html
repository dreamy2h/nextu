<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Juego de Damas Cl√°sico</title>
	<link rel="stylesheet" type="text/css" href="jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="css/estilo.css">
	<script type="text/javascript" src="jquery-ui/external/jquery/jquery.js"></script>
	<script type="text/javascript" src="jquery-ui/jquery-ui.min.js"></script>
	<script type="text/javascript">
		function borrar(identificador) {
			var row = parseInt($("#" + identificador).attr("data-row"));
			var col = parseInt($("#" + identificador).attr("data-col"));
			var row_previus = parseInt(ui.draggable.parent().attr("id").substr(4, 1));
			var col_previus = parseInt(ui.draggable.parent().attr("id").substr(10, 1));
			console.warn(row + ", " + col);
			$(ui.draggable).appendTo($("#" + identificador));
			if(ui.draggable.hasClass("piezas1")) {
				if((row - 2) == row_previus) {
					col_ = (col_previus > col) ? col_previus - 1 : col_previus + 1;
					div_id = 'row_' + (row - 1) + "_col_" + col_;
					$("#" + div_id).empty();
				}
			} else {
				if((row + 2) == row_previus) {
					col_ = (col_previus > col) ? col_previus - 1 : col_previus + 1;
					div_id = 'row-' + (row + 1) + "-col-" + col_;
					$("#" + div_id).empty();
				}
				return ((row_drop - 1) == row && (col_drop -1 == col || col_drop + 1 == col) && (! $("#" + identificador).children().length > 0 ));
			}
		}

		function aceptar(identificador, d) {
			var parentDiv = d.parent().prop('id');
			var row = parseInt(parentDiv.substr(4, 1));
			var col = parseInt(parentDiv.substr(10, 1));
			// console.warn(row + ", " + col);
			var row_drop = parseInt($("#" + identificador).attr("data-row"));
			var col_drop = parseInt($("#" + identificador).attr("data-col"));
			console.warn(row_drop + ", " + col_drop);
			if (d.hasClass( "piezas1" )) {
				if((row_drop - 2) == row) {
					col_previus = (col > col_drop) ? col_drop + 1 : col_drop - 1;
					div_id = 'row-' + (row_drop - 1) + "-col-" + col_previus;
					return ($("#"+div_id).children().hasClass("ficha2") && ! $("#" + identificador).children().length > 0 );
				}
			} else {
				if((row_drop + 2) == row) {
					col_previus = (col > col_drop) ? col_drop + 1 : col_drop - 1;
					div_id = 'row-' + (row_drop + 1) + "-col-" + col_previus;
					return ($("#"+div_id).children().hasClass("ficha1") && ! $("#" + identificador).children().length > 0 );
				}
				return ((row_drop + 1) == row && (col_drop -1 == col || col_drop + 1 == col) && (! $("#" + identificador).children().length > 0 ));
			}
		}
		
		$(document).ready(function() {
			$(".piezas1").draggable({ revert: "invalid" });
			$(".piezas2").draggable({ revert: "invalid" });

			$("#row_1_col_2").droppable({
				drop: function(event, ui) {
					borrar("row_1_col_2", event, ui);
				},
				accept: function(d) {
					aceptar("row_1_col_2", d);
				}
			});

			$("#row_1_col_4").droppable({
				drop: function(event, ui) {
					borrar("row_1_col_4", event, ui);
				},
				accept: function(d) {
					aceptar("row_1_col_4", d);
				}
			});

			$("#row_1_col_6").droppable({
				drop: function(event, ui) {
					borrar("row_1_col_6", event, ui);
				},
				accept: function(d) {
					aceptar("row_1_col_6", d);
				}
			});

			$("#row_1_col_8").droppable({
				drop: function(event, ui) {
					borrar("row_1_col_8", event, ui);
				},
				accept: function(d) {
					aceptar("row_1_col_8", d);
				}
			});

			$("#row_2_col_1").droppable({
				drop: function(event, ui) {
					borrar("row_2_col_1", event, ui);
				},
				accept: function(d) {
					aceptar("row_2_col_1", d);
				}
			});

			$("#row_2_col_3").droppable({
				drop: function(event, ui) {
					borrar("row_2_col_3", event, ui);
				},
				accept: function(d) {
					aceptar("row_2_col_3", d);
				}
			});

			$("#row_2_col_5").droppable({
				drop: function(event, ui) {
					borrar("row_2_col_5", event, ui);
				},
				accept: function(d) {
					aceptar("row_2_col_5", d);
				}
			});

			$("#row_2_col_7").droppable({
				drop: function(event, ui) {
					borrar("row_2_col_7", event, ui);
				},
				accept: function(d) {
					aceptar("row_2_col_7", d);
				}
			});

			$("#row_3_col_2").droppable({
				drop: function(event, ui) {
					borrar("row_3_col_2", event, ui);
				},
				accept: function(d) {
					aceptar("row_3_col_2", d);
				}
			});

			$("#row_3_col_4").droppable({
				drop: function(event, ui) {
					borrar("row_3_col_4", event, ui);
				},
				accept: function(d) {
					aceptar("row_3_col_4", d);
				}
			});

			$("#row_3_col_6").droppable({
				drop: function(event, ui) {
					borrar("row_3_col_6", event, ui);
				},
				accept: function(d) {
					aceptar("row_3_col_6", d);
				}
			});

			$("#row_3_col_8").droppable({
				drop: function(event, ui) {
					borrar("row_3_col_8", event, ui);
				},
				accept: function(d) {
					aceptar("row_3_col_8", d);
				}
			});
		});
	</script>
</head>
<body>
	<div id="tablero">
		<div id="row_1" class="row">
			<div class="cuadro_oscuro"></div>
			<div id="row_1_col_2" class="cuadro_claro ui-droppable" data-row="1" data-col="2">
				<div id="pieza1_row_1_col_2" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_1_col_4" class="cuadro_claro ui-droppable" data-row="1" data-col="4">
				<div id="pieza1_row_1_col_4" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_1_col_6" class="cuadro_claro ui-droppable" data-row="1" data-col="6">
				<div id="pieza1_row_1_col_6" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_1_col_8" class="cuadro_claro ui-droppable" data-row="1" data-col="8">
				<div id="pieza1_row_1_col_8" class="piezas1"></div>
			</div>
		</div>
		<br>

		<div id="row_2" class="row">
			<div id="row_2_col_1" class="cuadro_claro ui-droppable" data-row="2" data-col="1">
				<div id="pieza_1_row_2_col_1" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_2_col_3" class="cuadro_claro ui-droppable" data-row="2" data-col="3">
				<div id="pieza_1_row_2_col_3" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_2_col_5" class="cuadro_claro ui-droppable" data-row="2" data-col="5">
				<div id="pieza_1_row_2_col_5" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_2_col_7" class="cuadro_claro ui-droppable" data-row="2" data-col="7">
				<div id="pieza_1_row_2_col_7" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
		</div>
		<br>

		<div id="row_3" class="row">
			<div class="cuadro_oscuro"></div>
			<div id="row_3_col_2" class="cuadro_claro ui-droppable" data-row="3" data-col="2">
				<div id="pieza1_row_3_col_2" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_3_col_4" class="cuadro_claro ui-droppable" data-row="3" data-col="4">
				<div id="pieza1_row_3_col_4" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_3_col_6" class="cuadro_claro ui-droppable" data-row="3" data-col="6">
				<div id="pieza1_row_3_col_6" class="piezas1"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_3_col_8" class="cuadro_claro ui-droppable" data-row="3" data-col="8">
				<div id="pieza1_row_3_col_8" class="piezas1"></div>
			</div>
		</div>
		<br>

		<div id="row_4" class="row">
			<div id="row_4_col_1" class="cuadro_claro ui-droppable" data-row="4" data-col="1"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_4_col_3" class="cuadro_claro ui-droppable" data-row="4" data-col="3"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_4_col_5" class="cuadro_claro ui-droppable" data-row="4" data-col="5"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_4_col_7" class="cuadro_claro ui-droppable" data-row="4" data-col="7"></div>
			<div class="cuadro_oscuro"></div>
		</div>
		<br>

		<div id="row_5" class="row">
			<div class="cuadro_oscuro"></div>
			<div id="row_5_col_2" class="cuadro_claro ui-droppable" data-row="5" data-col="2"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_5_col_4" class="cuadro_claro ui-droppable" data-row="5" data-col="4"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_5_col_6" class="cuadro_claro ui-droppable" data-row="5" data-col="6"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_5_col_8" class="cuadro_claro ui-droppable" data-row="5" data-col="8"></div>
		</div>
		<br>

		<div id="row_6" class="row">
			<div id="row_6_col_1" class="cuadro_claro ui-droppable" data-row="6" data-col="1"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_6_col_3" class="cuadro_claro ui-droppable" data-row="6" data-col="3"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_6_col_5" class="cuadro_claro ui-droppable" data-row="6" data-col="5"></div>
			<div class="cuadro_oscuro"></div>
			<div id="row_6_col_7" class="cuadro_claro ui-droppable" data-row="6" data-col="7"></div>
			<div class="cuadro_oscuro"></div>
		</div>
		<br>

		<div id="row_7" class="row">
			<div class="cuadro_oscuro"></div>
			<div id="row_7_col_2" class="cuadro_claro ui-droppable" data-row="7" data-col="2">
				<div id="pieza2_row_7_col_2" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_7_col_4" class="cuadro_claro ui-droppable" data-row="7" data-col="4">
				<div id="pieza2_row_7_col_4" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_7_col_6" class="cuadro_claro ui-droppable" data-row="7" data-col="6">
				<div id="pieza2_row_7_col_6" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_7_col_8" class="cuadro_claro ui-droppable" data-row="7" data-col="8">
				<div id="pieza2_row_7_col_8" class="piezas2"></div>
			</div>
		</div>
		<br>

		<div id="row_8" class="row">
			<div id="row_8_col_1" class="cuadro_claro ui-droppable" data-row="8" data-col="1">
				<div id="pieza_2_row_8_col_1" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_8_col_3" class="cuadro_claro ui-droppable" data-row="8" data-col="3">
				<div id="pieza_2_row_8_col_3" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_8_col_5" class="cuadro_claro ui-droppable" data-row="8" data-col="5">
				<div id="pieza_2_row_8_col_5" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_8_col_7" class="cuadro_claro ui-droppable" data-row="8" data-col="7">
				<div id="pieza_2_row_8_col_7" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
		</div>
		<br>

		<div id="row_9" class="row">
			<div class="cuadro_oscuro"></div>
			<div id="row_9_col_2" class="cuadro_claro ui-droppable" data-row="9" data-col="2">
				<div id="pieza2_row_9_col_2" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_9_col_4" class="cuadro_claro ui-droppable" data-row="9" data-col="4">
				<div id="pieza2_row_9_col_4" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_9_col_6" class="cuadro_claro ui-droppable" data-row="9" data-col="6">
				<div id="pieza2_row_9_col_6" class="piezas2"></div>
			</div>
			<div class="cuadro_oscuro"></div>
			<div id="row_9_col_8" class="cuadro_claro ui-droppable" data-row="9" data-col="8">
				<div id="pieza2_row_9_col_8" class="piezas2"></div>
			</div>
		</div>
	</div>
</body>
</html>